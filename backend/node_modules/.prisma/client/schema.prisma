generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String    @id @default(uuid())
  name         String
  email        String    @unique
  passwordHash String
  role         String    @default("customer")
  createdAt    DateTime  @default(now())
  refreshToken String?
  bookings     Booking[]
  reviews      Review[]

  @@map("users")
}

model Package {
  id         String    @id @default(uuid())
  title      String
  slug       String    @unique
  shortDesc  String?
  overview   String?
  itinerary  Json?
  inclusions Json?
  price      Float
  currency   String    @default("INR")
  images     Json?
  active     Boolean   @default(true)
  createdBy  String
  createdAt  DateTime  @default(now())
  bookings   Booking[]
  reviews    Review[]

  @@map("packages")
}

model Booking {
  id          String    @id @default(uuid())
  customer    User      @relation(fields: [customerId], references: [id], onDelete: Cascade)
  customerId  String
  package     Package   @relation(fields: [packageId], references: [id], onDelete: Cascade)
  packageId   String
  quantity    Int       @default(1)
  totalPrice  Float
  status      String    @default("pending") // pending, approved, cancelled, completed
  bookingDate DateTime  @default(now())
  travelStart DateTime?
  travelEnd   DateTime?
  notes       String?

  @@map("bookings")
}

model Review {
  id         String   @id @default(uuid())
  package    Package  @relation(fields: [packageId], references: [id], onDelete: Cascade)
  packageId  String
  customer   User     @relation(fields: [customerId], references: [id], onDelete: Cascade)
  customerId String
  rating     Int // 1-5 stars
  comment    String?
  createdAt  DateTime @default(now())

  @@map("reviews")
}
